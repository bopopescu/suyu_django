# -*-coding:utf-8 -*-import MySQLdbimport jsonfrom scripts.constant import DB_INFOfrom scripts.database import CDataBasedef db_conn():	try:		db_key = 'china_gmdb'		db_info = DB_INFO.get(db_key)		conn = MySQLdb.connect(host=db_info['host'], user=db_info['user'], passwd=db_info['pwd'], db=db_info['dbname'],		                     port=db_info['port'])		return conn	except MySQLdb.Error, e:		print "Mysqldb Error:%s" % eclass hefu(object):	def __init__(self,id):		self.id = id		self.game = self.hefu_info(1)		self.server_id = self.hefu_info(4)			def hefu_info(self,d):		con = db_conn()		cursor = con.cursor()		cursor.execute('select * from server_combine where id = %s',self.id)		data = cursor.fetchall()		cursor.close()		con.close()		for a in data:			b = list(a)			return b[d]		def hefu_id_info(self,*args):		con = db_conn()		cursor = con.cursor()		print self.game		print self.server_id		sql = "select * from game_servers where game='%s' and server = %s"%(self.game,self.server_id)		cursor.execute(sql)		data = cursor.fetchall()		cursor.close()		con.close()		for a in data:			print a			if not args:				return list(a)			if list(args)[0] == 24:				return a[24][0:-5]			else:				return a[list(args)[0]]		def game_info(game,app_id):	con = db_conn()	cursor = con.cursor()	sql = "select * from game_servers where game='%s' and app_id = %s"%(game,app_id)	cursor.execute(sql)	data = cursor.fetchall()	cursor.close()	con.close()	for a in data:		b = list(a)		return bdef server_apply(id):	con = db_conn()	cursor = con.cursor()	cursor.execute('select * from server_apply where gid = %s',id)	data = cursor.fetchall()	print data	cursor.close()	con.close()	for a in data:		b = list(a)		return b		# a = hefu('584')# b = a.hefu_id_info(24)# print b