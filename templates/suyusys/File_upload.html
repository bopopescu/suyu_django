{% extends 'newindex.html' %}{% block nav_file_command %}active{% endblock %}{% block nav_file_upload %}active{% endblock %}{% block head %}    <link href="/static/css/saltstack/plugins/iCheck/custom.css" rel="stylesheet" xmlns="http://www.w3.org/1999/html">    <link href="/static/css/saltstack/plugins/chosen/bootstrap-chosen.css" rel="stylesheet">    <link href="/static/css/saltstack/plugins/chosen/bootstrap-chosen.css" rel="stylesheet">  <style>    html, body {      height: 100%;    }    #actions {      margin: 2em 0;    }    div.table {      display: table;    }    div.table .file-row {      display: table-row;    }    div.table .file-row > div {      display: table-cell;      vertical-align: top;      border-top: 1px solid #ddd;      padding: 8px;    }    div.table .file-row:nth-child(odd) {      background: #f9f9f9;    }    #total-progress {      opacity: 0;      transition: opacity 0.3s linear;    }    #previews .file-row.dz-success .progress {      opacity: 0;      transition: opacity 0.3s linear;    }    #previews .file-row .delete {      display: none;    }    #previews .file-row.dz-success .start,    #previews .file-row.dz-success .cancel {      display: none;    }    #previews .file-row.dz-success .delete {      display: block;    }  </style>{% endblock %}{% block test %}    <div class="wrapper wrapper-content animated fadeInRight">    <div class="row">        <div class="col-lg-12">            <div class="ibox">                <div class="ibox-title">                    <h5>Select path</h5>                </div>                <div class="ibox-content">                    <div class="row">                        <div class="col-md-4">                            <select class="chosen-select form-control" multiple="multiple">                                <option value="Mayotte">Mayotte</option>                                <option value="Mexico">Mexico</option>                                <option value="Micronesia, Federated States of">Micronesia, Federated States of</option>                                <option value="Moldova, Republic of">Moldova, Republic of</option>                                <option value="Monaco">Monaco</option>                                <option value="Mongolia">Mongolia</option>                                <option value="Montenegro">Montenegro</option>                                <option value="Montserrat">Montserrat</option>                                <option value="Morocco">Morocco</option>                                <option value="Mozambique">Mozambique</option>                                <option value="Myanmar">Myanmar</option>                                <option value="Namibia">Namibia</option>                                <option value="Nauru">Nauru</option>                                <option value="Nepal">Nepal</option>                                <option value="Netherlands">Netherlands</option>                                <option value="New Caledonia">New Caledonia</option>                                <option value="New Zealand">New Zealand</option>                                <option value="Nicaragua">Nicaragua</option>                            </select>                        </div>                    </div>                </div>            </div>        </div>    </div>    </div>    <div class="row">        <div class="col-lg-12">            <div class="container" id="container">                <h2 class="lead">file upload</h2>                <div id="actions" class="row">                    <div class="col-lg-7">                        <span class="btn btn-success fileinput-button">                            <i class="glyphicon glyphicon-plus"></i>                            <span>Add files...</span>                        </span>                        <button type="submit" class="btn btn-primary start">                            <i class="glyphicon glyphicon-upload"></i>                            <span>Start upload</span>                        </button>                        <button type="reset" class="btn btn-warning cancel">                            <i class="glyphicon glyphicon-ban-circle"></i>                            <span>Cancel upload</span>                        </button>                    </div>                    <div class="col-lg-5">                        <!-- 总体的进度 -->                        <span class="fileupload-process">                          <div id="total-progress" class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">                            <div class="progress-bar progress-bar-success" style="width:0%;" data-dz-uploadprogress></div>                          </div>                        </span>                    </div>                </div>                <div class="table table-striped files" id="previews">            <div id="template" class="file-row">                <div>                    <span class="preview"><img data-dz-thumbnail /></span>                </div>                <div>                    <p class="name" data-dz-name ></p>                    <strong class="error text-danger" data-dz-errormessage></strong>                </div>                <div>                    <p class="size" data-dz-size></p>                    <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">                        <div class="progress-bar progress-bar-success" style="width:0%;" data-dz-uploadprogress></div>                    </div>                </div>            <div>            <button class="btn btn-primary start">                <i class="glyphicon glyphicon-upload"></i>                <span>Start</span>            </button>            <button data-dz-remove class="btn btn-warning cancel">                <i class="glyphicon glyphicon-ban-circle"></i>                <span>Cancel</span>            </button>            <button data-dz-remove class="btn btn-danger delete">                <i class="glyphicon glyphicon-trash"></i>                <span>Delete</span>            </button>        </div>      </div>    </div>            </div>        </div>    </div>{% endblock %}{% block js %}    <script src="/static/js/saltstack/plugins/chosen/chosen.jquery.js"></script>    <script src="/static/js/saltstack/plugins/select2/select2.full.min.js"></script>    <script src="/static/js/saltstack/plugins/dropzone/dropzone.js"></script>{% endblock %}{% block scripts %}    <script>    $(function() {        $('.chosen-select').chosen();        $('.chosen-select-deselect').chosen({ allow_single_deselect: true });      });    </script>    <script>    Dropzone.autoDiscover = false;    </script>    <script>      // Get the template HTML and remove it from the doument      var previewNode = document.querySelector("#template");      previewNode.id = "";      var previewTemplate = previewNode.parentNode.innerHTML;      //开始先删除单个文件的布局      previewNode.parentNode.removeChild(previewNode);      var myDropzone = new Dropzone(document.body, { // 指定拖拽区为body        url: "uploadsave",        thumbnailWidth: 80,        thumbnailHeight: 80,        parallelUploads: 20,        previewTemplate: previewTemplate,        autoQueue: false, // 当队列有文件，是否立刻自动上传到服务器        previewsContainer: "#previews", // 指定存放文件队列区        clickable: ".fileinput-button" // 点击某个按钮或区域后出现选择电脑中本地图片，默认是previewsContainer指定的区域      });      myDropzone.on("addedfile", function(file) {        // 让模版中的单个文件可以点击上传        file.previewElement.querySelector(".start").onclick = function() { myDropzone.enqueueFile(file); };      });      // 显示所有文件整体上传进度1-100      myDropzone.on("totaluploadprogress", function(progress) {        document.querySelector("#total-progress .progress-bar").style.width = progress + "%";      });      myDropzone.on("sending", function(file) {        // 显示整体的上传的进度条，说明：原来是0，所以上面的style.width = progress + "%"即使是100%也看不到        document.querySelector("#total-progress").style.opacity = "1";        // 失效上传按钮        file.previewElement.querySelector(".start").setAttribute("disabled", "disabled");      });      // 当没有文件上传时，隐藏进度条      myDropzone.on("queuecomplete", function(progress) {        document.querySelector("#total-progress").style.opacity = "0";      });      // 上传所有      document.querySelector("#actions .start").onclick = function() {         myDropzone.enqueueFiles(myDropzone.getAcceptedFiles());        //myDropzone.enqueueFiles(myDropzone.getFilesWithStatus(Dropzone.ADDED));与上面一样，可查看源码对比      };      //取消所有      document.querySelector("#actions .cancel").onclick = function() {        myDropzone.removeAllFiles(true);      };</script>{% endblock %}